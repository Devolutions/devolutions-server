{
  "info": {
    "_postman_id": "4cd30733-b4ad-4ae2-90ae-e8b9aba4f450",
    "name": "Devolutions Server REST Services (Public)",
    "schema": "https://schema.getpostman.com/json/collection/v2.0.0/collection.json"
  },
  "item": [
    {
      "name": "Authentication",
      "item": [
        {
          "name": "Logout",
          "event": [
            {
              "listen": "test",
              "script": {
                "id": "eb0ca2df-27ae-4528-b262-34d3d0f9922b",
                "exec": [
                  "pm.response.to.have.status(200);",
                  "postman.setEnvironmentVariable(\"token\", \"\");",
                  "postman.setEnvironmentVariable(\"userID\", \"\");",
                  ""
                ],
                "type": "text/javascript"
              }
            }
          ],
          "_postman_id": "9d87795f-6dd1-4340-84cf-07b4478259f7",
          "protocolProfileBehavior": {
            "disableBodyPruning": true
          },
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Accept",
                "value": "application/json, text/plain, */*",
                "type": "text"
              },
              {
                "key": "Accept-Encoding",
                "value": "gzip, deflate, br",
                "type": "text"
              },
              {
                "key": "Content-Type",
                "value": "application/json",
                "type": "text"
              }
            ],
            "url": "{{url}}/api/v2/logout"
          },
          "response": [
            {
              "id": "0fd0e9d6-4f3f-4f29-afa1-140219756c2d",
              "name": "Logout",
              "originalRequest": {
                "method": "GET",
                "header": [
                  {
                    "key": "Accept",
                    "value": "application/json, text/plain, */*",
                    "type": "text"
                  },
                  {
                    "key": "Accept-Encoding",
                    "value": "gzip, deflate, br",
                    "type": "text"
                  },
                  {
                    "key": "Content-Type",
                    "value": "application/json",
                    "type": "text"
                  },
                  {
                    "key": "tokenid",
                    "value": "{{token}}",
                    "type": "text"
                  }
                ],
                "url": "http://localhost/api/logout"
              },
              "status": "OK",
              "code": 200,
              "_postman_previewlanguage": "json",
              "header": [],
              "cookie": [],
              "responseTime": null,
              "body": "{\n    \"result\": 1\n}"
            }
          ]
        },
        {
          "name": "GetServerInfo",
          "event": [
            {
              "listen": "test",
              "script": {
                "id": "48864048-dc26-485b-9dd7-3d2658db068d",
                "exec": [
                  "eval(postman.getGlobalVariable(\"jsbn_script\"));",
                  "",
                  "var session_key = generateKey(256);",
                  "",
                  "postman.setEnvironmentVariable(\"sessionkey\", session_key);",
                  "",
                  "var jsonData = JSON.parse(responseBody);",
                  "",
                  "postman.setEnvironmentVariable(\"publickey_mod\", jsonData.data.publicKey.modulus);",
                  "postman.setEnvironmentVariable(\"publickey_exp\", jsonData.data.publicKey.exponent);",
                  "",
                  "console.log(\"session key:\" + session_key);",
                  "console.log(\"modulus:\" + jsonData.data.publicKey.modulus);",
                  "console.log(\"exponent:\" + jsonData.data.publicKey.exponent);",
                  "",
                  "var rsa = new RSAKey();",
                  "rsa.setPublic(postman.getEnvironmentVariable(\"publickey_mod\"), postman.getEnvironmentVariable(\"publickey_exp\"));",
                  "var safeSessionKey = rsa.encrypt(session_key);",
                  "console.log(\"safe session key:\" + safeSessionKey);",
                  "",
                  "postman.setEnvironmentVariable(\"EncryptedSessionKey\", safeSessionKey);",
                  "tests[\"GetServerInfo\"] = jsonData.result === 1;",
                  ""
                ],
                "type": "text/javascript"
              }
            }
          ],
          "_postman_id": "d80ea204-709f-4c8f-8e3a-088aac123d25",
          "protocolProfileBehavior": {
            "disableBodyPruning": true
          },
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Accept",
                "value": "application/json, text/plain, */*",
                "type": "text"
              },
              {
                "key": "Accept-Encoding",
                "value": "gzip, deflate, br",
                "type": "text"
              },
              {
                "key": "Content-Type",
                "value": "application/json",
                "type": "text"
              }
            ],
            "url": "{{url}}/api/v2/system/info"
          },
          "response": [
            {
              "id": "c41d5e37-6eaa-4a32-8996-bd016c08579b",
              "name": "Get ServerInfo",
              "originalRequest": {
                "method": "GET",
                "header": [
                  {
                    "key": "Accept",
                    "value": "application/json, text/plain, */*"
                  },
                  {
                    "key": "Content-Type",
                    "value": "application/json"
                  },
                  {
                    "key": "Accept-Encoding",
                    "value": "gzip, deflate, br"
                  }
                ],
                "url": "http://localhost/api/server-information"
              },
              "status": "OK",
              "code": 200,
              "_postman_previewlanguage": "json",
              "header": [],
              "cookie": [],
              "responseTime": null,
              "body": "{\n    \"data\": {\n        \"publicKey\": {\n            \"exponent\": \"011001\",\n            \"modulus\": \"E6F5501B1138A2E2CC5208825FBABA6543DD30352346959D4E16E46150C5560AE3CB340DD51F3CED815E8AB7C60FB7DA68775DCBDEB51D006F5616FB97EB26FABA3E0B9F96AB3F6D5832565973ED7248F494E1483723A8EDA36605667FB3060CD2D9A0A322CCEEE2D6FC8C45B677B5AC6A7030536B9415ACC22DC70C958A0D8C\"\n        },\n        \"selectedTimeZoneId\": \"Eastern Standard Time\",\n        \"serverDescription\": \"Showcase environment\",\n        \"servername\": \"DPSShowcase\",\n        \"version\": \"2019.2.8.0\"\n    },\n    \"result\": 1\n}"
            }
          ]
        },
        {
          "name": "Login",
          "event": [
            {
              "listen": "test",
              "script": {
                "id": "57f434cb-cb91-4a8d-8714-abb601633b2f",
                "exec": [
                  "var jsonData = JSON.parse(responseBody);",
                  "console.log(jsonData);",
                  "postman.setEnvironmentVariable(\"token\", jsonData.tokenId);",
                  "tests[\"Login User\"] = jsonData.sessionKey.length > 1;",
                  ""
                ],
                "type": "text/javascript"
              }
            },
            {
              "listen": "prerequest",
              "script": {
                "id": "49f9cc35-d749-4528-8060-1323d5fcebee",
                "exec": [
                  "eval(postman.getGlobalVariable(\"encrypt_data\"));",
                  "var safePassword = encrypt_data(postman.getEnvironmentVariable(\"ClearPassword\"));",
                  "postman.setEnvironmentVariable(\"EncryptedPassword\", safePassword);"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "_postman_id": "1729ef41-0d39-41f0-8726-9fdc85e62285",
          "protocolProfileBehavior": {
            "disableBodyPruning": true
          },
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Accept",
                "value": "application/json, text/plain, */*",
                "type": "text"
              },
              {
                "key": "Accept-Encoding",
                "value": "gzip, deflate, br",
                "type": "text"
              },
              {
                "key": "Content-Type",
                "value": "application/json",
                "type": "text"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n    \"userName\": \"{{Username}}\",\n    \"RDMOLoginParameters\": {\n        \"SafePassword\": \"{{EncryptedPassword}}\",\n        \"SafeSessionKey\": \"{{EncryptedSessionKey}}\"\n    }\n}",
              "options": {
                "raw": {}
              }
            },
            "url": "{{url}}/api/v2/login",
            "description": "Performs a login on your DPS instance.  Note that **ServerInfo** must have been called beforehand to obtain the values needed to encrypt sensitive information."
          },
          "response": [
            {
              "id": "00257071-494b-4da8-9fab-100b7d66a843",
              "name": "Login - Custom Login with 2FA",
              "originalRequest": {
                "method": "POST",
                "header": [
                  {
                    "key": "Accept",
                    "value": "application/json, text/plain, */*"
                  },
                  {
                    "key": "Origin",
                    "value": "http://localhost"
                  },
                  {
                    "key": "tokenId",
                    "value": "80cb79b4-45b6-4fe9-8814-0a5531467477"
                  },
                  {
                    "key": "User-Agent",
                    "value": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/63.0.3239.52 Safari/537.36"
                  },
                  {
                    "key": "Content-Type",
                    "value": "application/json"
                  },
                  {
                    "key": "Referer",
                    "value": "{{url}}/login"
                  },
                  {
                    "key": "Accept-Encoding",
                    "value": "gzip, deflate, br"
                  },
                  {
                    "key": "Accept-Language",
                    "value": "en-US,en;q=0.9,fr-CA;q=0.8,fr;q=0.7"
                  },
                  {
                    "key": "Cookie",
                    "value": "UserSettings=language=1; UserSettings=language=1"
                  },
                  {
                    "key": "profiler",
                    "type": "text",
                    "value": "true"
                  }
                ],
                "body": {
                  "mode": "raw",
                  "raw": "{\n    \"userName\": \"{{Username}}\",\n    \"RDMOLoginParameters\": {\n        \"Version\": \"\",\n        \"Client\": \"\",\n        \"Platform\": \"\",\n        \"Password\": null,\n        \"SafePassword\": \"{{EncryptedPassword}}\",\n        \"SafeSessionKey\": \"{{EncryptedSessionKey}}\",\n        \"TwoFactorID\": null\n    },\n    \"TwoFactorInfo\": null\n}"
                },
                "url": "http://localhost/api/login/partial"
              },
              "status": "OK",
              "code": 200,
              "_postman_previewlanguage": "json",
              "header": [
                {
                  "key": "Cache-Control",
                  "value": "no-store, must-revalidate, no-cache"
                },
                {
                  "key": "Content-Length",
                  "value": "2308"
                },
                {
                  "key": "Content-Type",
                  "value": "application/json"
                },
                {
                  "key": "Content-Encoding",
                  "value": "gzip"
                },
                {
                  "key": "Server",
                  "value": "Microsoft-IIS/10.0"
                },
                {
                  "key": "Access-Control-Allow-Origin",
                  "value": "*"
                },
                {
                  "key": "Access-Control-Allow-Credentials",
                  "value": "true"
                },
                {
                  "key": "X-AspNet-Version",
                  "value": "4.0.30319"
                },
                {
                  "key": "X-Powered-By",
                  "value": "ASP.NET"
                },
                {
                  "key": "Date",
                  "value": "Tue, 26 Nov 2019 18:43:09 GMT"
                }
              ],
              "cookie": [],
              "responseTime": null,
              "body": ""
            },
            {
              "id": "16af763f-cc7a-436d-bfe7-c4b95a331baf",
              "name": "Login - Custom Login",
              "originalRequest": {
                "method": "POST",
                "header": [
                  {
                    "key": "Accept",
                    "value": "application/json, text/plain, */*"
                  },
                  {
                    "key": "Content-Type",
                    "name": "Content-Type",
                    "value": "application/x-www-form-urlencoded",
                    "type": "text"
                  },
                  {
                    "key": "Accept-Encoding",
                    "value": "gzip, deflate, br"
                  }
                ],
                "body": {
                  "mode": "raw",
                  "raw": "{\n    \"userName\": \"{{Username}}\",\n    \"RDMOLoginParameters\": {\n        \"SafePassword\": \"{{EncryptedPassword}}\",\n        \"SafeSessionKey\": \"{{EncryptedSessionKey}}\",\n    }\n}"
                },
                "url": "http://localhost/api/login/partial"
              },
              "status": "OK",
              "code": 200,
              "_postman_previewlanguage": "json",
              "header": [],
              "cookie": [],
              "responseTime": null,
              "body": ""
            },
            {
              "id": "241844a4-0c43-4f56-b22b-ed22910f85cf",
              "name": "Login - Active Directory",
              "originalRequest": {
                "method": "POST",
                "header": [
                  {
                    "key": "Accept",
                    "value": "application/json, text/plain, */*",
                    "type": "text"
                  },
                  {
                    "key": "Content-Type",
                    "value": "application/json",
                    "type": "text"
                  },
                  {
                    "key": "Accept-Encoding",
                    "value": "gzip, deflate, br",
                    "type": "text"
                  }
                ],
                "body": {
                  "mode": "raw",
                  "raw": "{\n    \"userName\": \"{{Username}}\",\n    \"RDMOLoginParameters\": {\n        \"SafePassword\": \"{{EncryptedPassword}}\",\n        \"SafeSessionKey\": \"{{EncryptedSessionKey}}\"\n    }\n}"
                },
                "url": "http://localhost/api/login/partial"
              },
              "status": "OK",
              "code": 200,
              "_postman_previewlanguage": "json",
              "header": [
                {
                  "key": "Cache-Control",
                  "value": "no-store, must-revalidate, no-cache"
                },
                {
                  "key": "Content-Length",
                  "value": "2103"
                },
                {
                  "key": "Content-Type",
                  "value": "application/json"
                },
                {
                  "key": "Content-Encoding",
                  "value": "gzip"
                },
                {
                  "key": "Server",
                  "value": "Microsoft-IIS/10.0"
                },
                {
                  "key": "X-AspNet-Version",
                  "value": "4.0.30319"
                },
                {
                  "key": "X-Powered-By",
                  "value": "ASP.NET"
                },
                {
                  "key": "Date",
                  "value": "Tue, 26 Nov 2019 19:14:02 GMT"
                }
              ],
              "cookie": [],
              "responseTime": null,
              "body": ""
            }
          ]
        }
      ],
      "_postman_id": "0f9b69f4-2600-4b3f-9af4-5df483a8d599"
    },
    {
      "name": "PAM",
      "item": [
        {
          "name": "Accounts",
          "item": [],
          "_postman_id": "437f7550-0ec5-4e2e-a3af-34f6d85dc51d",
          "_postman_isSubFolder": true
        },
        {
          "name": "Providers",
          "item": [],
          "_postman_id": "39e97997-3530-4b39-ad24-25c35c27a509",
          "_postman_isSubFolder": true
        },
        {
          "name": "Requests",
          "item": [],
          "_postman_id": "8311917b-6c4a-4f84-ae24-d5635d8a8da9",
          "_postman_isSubFolder": true
        }
      ],
      "_postman_id": "a6cdef07-45a7-41aa-a396-59125c52dabe"
    },
    {
      "name": "Connections",
      "item": [
        {
          "name": "GetConnectionSensitiveData",
          "_postman_id": "08705054-3198-4091-bdc9-554182f1270f",
          "protocolProfileBehavior": {
            "disableBodyPruning": true
          },
          "request": {
            "method": "GET",
            "header": [],
            "url": ""
          },
          "response": []
        }
      ],
      "_postman_id": "affb83b5-a4ab-412f-9c34-3be85509e228"
    },
    {
      "name": "Vaults",
      "item": [],
      "_postman_id": "1c5f9f72-e18c-4878-a215-fd709b6596bd"
    }
  ]
}